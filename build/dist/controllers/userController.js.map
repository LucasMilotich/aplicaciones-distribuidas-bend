{"version":3,"sources":["../../../dist/controllers/userController.js"],"names":["Object","defineProperty","exports","value","_mongo","_interopRequireDefault","require","obj","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","prototype","errorBuilder","UserController","register","req","res","next","username","body","password","mongo","save","then","elem","console","log","send","changePassword","new_password","update","err","login","get"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _mongo = _interopRequireDefault(require(\"../db/mongo\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar errorBuilder = require('../domain/error');\n\nvar UserController =\n/*#__PURE__*/\nfunction () {\n  function UserController() {\n    _classCallCheck(this, UserController);\n  }\n\n  _createClass(UserController, [{\n    key: \"register\",\n    value: function register(req, res, next) {\n      var username = req.body.username;\n      var password = req.body.password;\n      var mongo = new _mongo[\"default\"]();\n      mongo.save(\"users\", {\n        username: username,\n        password: password\n      }).then(function (elem) {\n        console.log(elem);\n\n        if (elem == null) {\n          res.send(errorBuilder(\"user not found\", 400, \"not_found\"));\n        } else {\n          res.send(elem);\n        }\n      });\n    }\n  }, {\n    key: \"changePassword\",\n    value: function changePassword(req, res, next) {\n      var username = req.body.username;\n      var password = req.body.new_password;\n      var mongo = new _mongo[\"default\"]();\n      mongo.update(\"users\", {\n        username: username\n      }, {\n        username: username,\n        password: password\n      }).then(function (elem) {\n        if (elem == null) {\n          res.send(errorBuilder(\"user cannot change password\", 400, \"not_found\"));\n        } else {\n          res.send(elem);\n        }\n      })[\"catch\"](function (err) {\n        return res.send(errorBuilder(err, 500, \"internal_error\"));\n      });\n    }\n  }, {\n    key: \"login\",\n    value: function login(req, res, next) {\n      var username = req.body.username;\n      var password = req.body.password;\n      var mongo = new _mongo[\"default\"]();\n      mongo.get(\"users\", {\n        username: username,\n        password: password\n      }).then(function (elem) {\n        if (elem == null) {\n          res.send(errorBuilder(\"user not found\", 400, \"not_found\"));\n        } else {\n          res.send(elem);\n        }\n      })[\"catch\"](function (err) {\n        return res.send(errorBuilder(err, 500, \"internal_error\"));\n      });\n    }\n  }]);\n\n  return UserController;\n}();\n\nexports[\"default\"] = UserController;"],"file":"userController.js"}